<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Attendance Tracker</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f4f6f8;
      line-height: 1.6;
    }

    h1, h2 {
      color: #333;
    }

    select, input[type="text"], button {
      padding: 12px;
      font-size: 16px;
      margin: 10px 0;
      width: 100%;
      max-width: 100%;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    #studentList {
      margin-top: 20px;
      background-color: white;
      padding: 10px;
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
      overflow-x: auto;
    }

    #studentList table {
      width: 100%;
      border-collapse: collapse;
      min-width: 400px;
    }

    #studentList th, #studentList td {
      padding: 8px 12px;
      border-bottom: 1px solid #ddd;
      text-align: left;
    }

    #studentList th {
      background: #f0f0f0;
    }

    .checkbox-cell {
      text-align: center;
    }

    .present-count {
      margin-top: 10px;
      font-weight: bold;
      color: green;
    }

    #presentRolls {
      white-space: pre-wrap;
      background: #fff;
      border: 1px solid #ccc;
      padding: 10px;
      margin-top: 10px;
      border-radius: 5px;
    }

    .copy-btn {
      background: #007bff;
      color: white;
      border: none;
      padding: 10px;
      border-radius: 5px;
      margin-top: 10px;
      cursor: pointer;
      width: 100%;
    }

    @media (max-width: 600px) {
      h1, h2 {
        font-size: 20px;
      }

      #studentList table {
        font-size: 14px;
      }
    }
  </style>
</head>
<body>

  <h1>📋 Student Attendance</h1>

  <label for="classSelect">Select Class:</label>
  <select id="classSelect">
    <option value="">-- Choose Class --</option>
    <option value="10">Class 10</option>
    <option value="12">Class 12</option>
  </select>

  <input type="text" id="searchInput" placeholder="🔍 Search student..." />

  <div id="studentList"></div>

  <button onclick="submitAttendance()">✅ Submit Attendance</button>

  <div class="present-count" id="countDisplay"></div>

  <h2>🎓 Present Students' Roll Numbers:</h2>
  <div id="presentRolls"></div>
  <button class="copy-btn" onclick="copyToClipboard()">📋 Copy to Clipboard</button>

  <script>
    const studentsByClass = {
      "10": [
        { name: "Alice", roll: "101" },
        { name: "Bob", roll: "102" },
        { name: "Charlie", roll: "103" }
      ],
      "12": [
        { name: "David", roll: "201" },
        { name: "Eva", roll: "202" },
        { name: "Frank", roll: "203" }
      ]
    };

    const allAttendance = {};

    function loadStudents(classId) {
      if (!classId) return;
      const container = document.getElementById("studentList");
      if (!allAttendance[classId]) allAttendance[classId] = {};
      const students = studentsByClass[classId];
      const tableId = `table-${classId}`;
      if (document.getElementById(tableId)) return;

      const table = document.createElement("table");
      table.id = tableId;
      table.innerHTML = `
        <thead>
          <tr><th colspan="3">Class ${classId}</th></tr>
          <tr><th>Name</th><th>Roll No</th><th>Present</th></tr>
        </thead>
        <tbody>
          ${students.map(student => `
            <tr>
              <td>${student.name}</td>
              <td>${student.roll}</td>
              <td class="checkbox-cell">
                <input type="checkbox" 
                       onchange="markAttendance('${classId}', '${student.roll}', this.checked)"
                       ${allAttendance[classId][student.roll] ? "checked" : ""}>
              </td>
            </tr>
          `).join("")}
        </tbody>
      `;
      container.appendChild(table);
    }

    function markAttendance(classId, roll, isPresent) {
      if (!allAttendance[classId]) allAttendance[classId] = {};
      allAttendance[classId][roll] = isPresent;
    }

    function submitAttendance() {
      const present = [];
      Object.entries(allAttendance).forEach(([classId, rolls]) => {
        Object.entries(rolls).forEach(([roll, isPresent]) => {
          if (isPresent) present.push(roll);
        });
      });

      document.getElementById("presentRolls").textContent = present.join(", ");
      document.getElementById("countDisplay").textContent = `Total Present: ${present.length}`;
    }

    function copyToClipboard() {
      const text = document.getElementById("presentRolls").textContent;
      navigator.clipboard.writeText(text).then(() => {
        alert("Copied to clipboard!");
      });
    }

    document.getElementById("classSelect").addEventListener("change", function () {
      loadStudents(this.value);
    });

    document.getElementById("searchInput").addEventListener("input", function () {
      const query = this.value.toLowerCase();
      const tables = document.querySelectorAll("#studentList table");

      tables.forEach(table => {
        const rows = table.querySelectorAll("tbody tr");
        rows.forEach(row => {
          const nameCell = row.cells[0].textContent.toLowerCase();
          row.style.display = nameCell.includes(query) ? "" : "none";
        });
      });
    });
  </script>

</body>
</html>
